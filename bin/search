#!/usr/bin/env php
<?php

namespace Vinhson\Search;

use Symfony\Component\Console\Application;
use Vinhson\Search\Commands\{PinCommand, ProxyCommand, TranslationCommand, UnProxyCommand};

$autoloads = [
    __DIR__ . '/../vendor/autoload.php',
    __DIR__ . '/../../../autoload.php'
];
foreach ($autoloads as $autoload) {
    if (file_exists($autoload)) {
        require_once $autoload;
    }
}

$path = getcwd();
$configPath = "{$path}/config.php";

if (in_array($configPath, glob("{$path}/*"))) {
    $configuration = require_once $configPath;
} else {
    $configuration = require_once __DIR__ . '/../config/config.php';
}
$config = new Config($configuration);

$app = new Application();
$app->add(new PinCommand($config));
$app->add(new ProxyCommand());
$app->add(new TranslationCommand($config));
$app->add(new UnProxyCommand());

try {
    $app->run();
} catch (\Exception $e) {
}
